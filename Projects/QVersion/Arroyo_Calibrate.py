import pyvisa as visa
from matplotlib import pyplot as plt

from Python_lib.Arroyo import Arroyo
from Python_lib.Arroyo_Calibrater import Arroyo_Calibrater
from Python_lib.Arroyo_Stub import Arroyo_Stub
from Python_lib.Yokogawa import Yokogawa

calibrater = Arroyo_Calibrater()
print(calibrater.calibrate())
#wavelength = [2318.945, 2319.0249999999996, 2319.1949999999997, 2319.355, 2319.525, 2319.705, 2319.8849999999998, 2320.075, 2320.275, 2320.475, 2320.675, 2320.8849999999998, 2321.105, 2321.3250000000003, 2321.545, 2321.775, 2322.0150000000003, 2322.2450000000003, 2322.485, 2322.735, 2322.9849999999997, 2323.245, 2323.505, 2323.7650000000003, 2324.035, 2324.305, 2324.585, 2324.875, 2325.155, 2319.015, 2319.205, 2319.365, 2319.535, 2319.715, 2319.895, 2320.085, 2320.275, 2320.475, 2320.675, 2320.875, 2321.085, 2321.295, 2321.525, 2321.745, 2321.975, 2322.205, 2322.445, 2322.685, 2322.935, 2323.185, 2323.4449999999997, 2323.695, 2323.965, 2324.235, 2324.5049999999997, 2324.785, 2325.065, 2325.355, 2319.1949999999997, 2319.415, 2319.565, 2319.735, 2319.915, 2320.0950000000003, 2320.285, 2320.475, 2320.675, 2320.875, 2321.0750000000003, 2321.285, 2321.4950000000003, 2321.7250000000004, 2321.9449999999997, 2322.1749999999997, 2322.4049999999997, 2322.645, 2322.885, 2323.135, 2323.3849999999998, 2323.6349999999998, 2323.895, 2324.1549999999997, 2324.435, 2324.705, 2324.985, 2325.265, 2325.555, 2319.405, 2319.615, 2319.775, 2319.945, 2320.115, 2320.295, 2320.4849999999997, 2320.675, 2320.875, 2321.065, 2321.275, 2321.485, 2321.705, 2321.9249999999997, 2322.145, 2322.375, 2322.605, 2322.8450000000003, 2323.085, 2323.335, 2323.585, 2323.835, 2324.095, 2324.355, 2324.625, 2324.9049999999997, 2325.185, 2325.465, 2325.755, 2319.585, 2319.815, 2319.9750000000004, 2320.145, 2320.3250000000003, 2320.505, 2320.685, 2320.875, 2321.065, 2321.265, 2321.475, 2321.685, 2321.905, 2322.115, 2322.335, 2322.565, 2322.795, 2323.035, 2323.285, 2323.525, 2323.775, 2324.035, 2324.295, 2324.555, 2324.825, 2325.105, 2325.385, 2325.665, 2325.955, 2319.835, 2320.015, 2320.175, 2320.355, 2320.525, 2320.705, 2320.8849999999998, 2321.0750000000003, 2321.265, 2321.4649999999997, 2321.675, 2321.8849999999998, 2322.095, 2322.315, 2322.5350000000003, 2322.7650000000003, 2323.005, 2323.235, 2323.485, 2323.725, 2323.975, 2324.2250000000004, 2324.495, 2324.755, 2325.0249999999996, 2325.305, 2325.585, 2325.8650000000002, 2326.155, 2320.085, 2320.235, 2320.385, 2320.5550000000003, 2320.725, 2320.905, 2321.085, 2321.275, 2321.4649999999997, 2321.665, 2321.875, 2322.085, 2322.2949999999996, 2322.515, 2322.735, 2322.965, 2323.205, 2323.435, 2323.6749999999997, 2323.9249999999997, 2324.175, 2324.435, 2324.695, 2324.955, 2325.225, 2325.505, 2325.785, 2326.065, 2326.355, 2320.3149999999996, 2320.4249999999997, 2320.595, 2320.755, 2320.925, 2321.105, 2321.285, 2321.475, 2321.665, 2321.875, 2322.0750000000003, 2322.2949999999996, 2322.485, 2322.715, 2322.935, 2323.165, 2323.405, 2323.6349999999998, 2323.875, 2324.1150000000002, 2324.375, 2324.635, 2324.895, 2325.155, 2325.4249999999997, 2325.705, 2325.985, 2326.2650000000003, 2326.5550000000003, 2320.435, 2320.635, 2320.795, 2320.965, 2321.125, 2321.305, 2321.485, 2321.675, 2321.875, 2322.0750000000003, 2322.275, 2322.485, 2322.6949999999997, 2322.915, 2323.135, 2323.3650000000002, 2323.5950000000003, 2323.835, 2324.075, 2324.315, 2324.5750000000003, 2324.825, 2325.0950000000003, 2325.355, 2325.625, 2325.9049999999997, 2326.185, 2326.465, 2326.755, 2320.7850000000003, 2320.835, 2321.0049999999997, 2321.155, 2321.335, 2321.505, 2321.6949999999997, 2321.8849999999998, 2322.0750000000003, 2322.275, 2322.4750000000004, 2322.675, 2322.895, 2323.1150000000002, 2323.335, 2323.565, 2323.795, 2324.035, 2324.275, 2324.525, 2324.775, 2325.0249999999996, 2325.295, 2325.555, 2325.825, 2326.105, 2326.385, 2326.6650000000004, 2326.955, 2320.975, 2321.035, 2321.205, 2321.365, 2321.535, 2321.715, 2321.895, 2322.085, 2322.275, 2322.4750000000004, 2322.665, 2322.885, 2323.095, 2323.315, 2323.5350000000003, 2323.7650000000003, 2323.9950000000003, 2324.235, 2324.475, 2324.725, 2324.975, 2325.235, 2325.495, 2325.755, 2326.0350000000003, 2326.305, 2326.585, 2326.875, 2327.155]
#current = [50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190]
#temperature = [20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]
#(array([ 2.31389091e+03,  2.39794447e-02,  1.52386054e-01,  1.17614905e-04,
       #  7.11415203e-05,  1.29244957e-03,  9.96585633e-07, -7.82251331e-06]), array([[ 2.45437543e-02, -2.06384560e-04, -1.89623382e-03,
       #   1.50410023e-05,  1.63775893e-07,  3.60600163e-05,
       #  -6.45321674e-09, -2.68133491e-07],
       # [-2.06384560e-04,  2.13761616e-06,  1.50434233e-05,
       #  -1.41847464e-07, -3.09957802e-09, -2.68252159e-07,
       #   1.22083404e-10,  2.23666554e-09],
       # [-1.89623382e-03,  1.50434233e-05,  1.50296373e-04,
       #  -1.15534009e-06, -6.47795414e-09, -2.93086918e-06,
       #   2.59480325e-10,  2.17923961e-08],
       # [ 1.50410023e-05, -1.41847464e-07, -1.15534009e-06,
       #   1.02909801e-08,  1.22298050e-10,  2.17980949e-08,
       #  -4.89524145e-12, -1.81747150e-10],
       # [ 1.63775893e-07, -3.09957802e-09, -6.47795414e-09,
       #   1.22298050e-10,  1.28888174e-11,  1.13840215e-12,
       #  -5.07493952e-13, -9.83413141e-15],
       # [ 3.60600163e-05, -2.68252159e-07, -2.93086918e-06,
       #   2.17980949e-08,  1.13840215e-12,  5.85990744e-08,
       #  -5.21909802e-14, -4.35693524e-10],
       # [-6.45321674e-09,  1.22083404e-10,  2.59480325e-10,
       #  -4.89524145e-12, -5.07493952e-13, -5.21909803e-14,
       #   2.03019880e-14,  4.48852633e-16],
       # [-2.68133491e-07,  2.23666554e-09,  2.17923961e-08,
       #  -1.81747150e-10, -9.83413140e-15, -4.35693524e-10,
       #   4.48852632e-16,  3.63263436e-12]]))



# [2318.8799999999997, 2319.18, 2319.52, 2319.88, 2320.27, 2320.67, 2321.0899999999997, 2321.54, 2322.0, 2322.48, 2322.98, 2323.5, 2324.03, 2324.58, 2325.15, 2319.04, 2319.36, 2319.71, 2320.08, 2320.4599999999996, 2320.87, 2321.29, 2321.74, 2322.2, 2322.6800000000003, 2323.18, 2323.69, 2324.22, 2324.78, 2325.35, 2319.24, 2319.5699999999997, 2319.91, 2320.2799999999997, 2320.66, 2321.07, 2321.49, 2321.94, 2322.4, 2322.88, 2323.38, 2323.89, 2324.42, 2324.98, 2325.55, 2319.44, 2319.77, 2320.1099999999997, 2320.48, 2320.8599999999997, 2321.2599999999998, 2321.69, 2322.14, 2322.59, 2323.08, 2323.57, 2324.09, 2324.62, 2325.1800000000003, 2325.74, 2319.64, 2319.98, 2320.31, 2320.68, 2321.06, 2321.46, 2321.89, 2322.3300000000004, 2322.79, 2323.27, 2323.77, 2324.2799999999997, 2324.8199999999997, 2325.37, 2325.94, 2319.86, 2320.1800000000003, 2320.52, 2320.88, 2321.2599999999998, 2321.66, 2322.0899999999997, 2322.53, 2322.9900000000002, 2323.47, 2323.9700000000003, 2324.48, 2325.02, 2325.5699999999997, 2326.15]
# [50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190]
# [20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]
# (array([ 2.31348863e+03,  2.26273409e-02,  2.00127891e-01, -1.40816348e-05,
#         9.47478970e-05]), array([[ 7.83750522e-04, -6.11518418e-06, -3.33780549e-05,
#          2.46226240e-07,  2.26155893e-09],
#        [-6.11518418e-06,  5.68696815e-08,  2.46150653e-07,
#         -2.05234742e-09, -4.34273120e-11],
#        [-3.33780549e-05,  2.46150653e-07,  1.48363878e-06,
#         -1.09448017e-08,  4.96556311e-13],
#        [ 2.46226240e-07, -2.05234742e-09, -1.09448017e-08,
#          9.12552294e-11, -4.13993963e-15],
#        [ 2.26155893e-09, -4.34273120e-11,  4.96556311e-13,
#         -4.13993963e-15,  1.81335948e-13]]))